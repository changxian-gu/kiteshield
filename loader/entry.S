.section .text
.global _start

_start:
  mov x29, #0 

#ifdef USE_RUNTIME
  bl do_fork

#endif

  mov x0, sp
  bl load

  sub sp, sp, #16
  str x0, [sp]

#ifdef USE_RUNTIME
  bl child_start_ptrace
#endif

  ldr x1, [sp] 
  cbz x1, exit_program

  mov x0, #0
  mov x2, #0
  mov x3, #0
  mov x4, #0
  mov x5, #0
  mov x6, #0
  mov x7, #0
  mov x8, #0
  mov x9, #0
  mov x10, #0
  mov x11, #0
  mov x12, #0
  mov x13, #0
  mov x14, #0
  mov x15, #0
  mov x16, #0
  mov x17, #0
  mov x18, #0
  mov x19, #0
  mov x20, #0
  mov x21, #0
  mov x22, #0
  mov x23, #0
  mov x24, #0
  mov x25, #0
  mov x26, #0
  mov x27, #0
  mov x28, #0

  ldr x1, [sp]
  add sp, sp, #16
  br x1  

exit_program:
  mov x0, #0 
  mov x8, #93 
  svc #0 